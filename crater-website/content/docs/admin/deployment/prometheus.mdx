---
title: Prometheus Stack éƒ¨ç½²æŒ‡å—
description: kube-prometheus-stack æä¾›å…¨é¢çš„ç›‘æ§åŠŸèƒ½ï¼ŒåŒ…æ‹¬ GPUã€ä½œä¸šç”Ÿå‘½å‘¨æœŸå’Œé›†ç¾¤æŒ‡æ ‡ï¼Œå¹¶ä½¿ç”¨ Rook Ceph RBD å­˜å‚¨åç«¯ã€‚

---

## æ¦‚è¿°

Crater ä¾èµ– **kube-prometheus-stack** æä¾›ä¸€ä¸ªå¼ºå¤§ä¸”å¯æ‰©å±•çš„ç›‘æ§è§£å†³æ–¹æ¡ˆã€‚å®ƒä¸ºä»¥ä¸‹å†…å®¹æä¾›å®æ—¶å’Œå†å²çš„å¯è§‚æµ‹æ€§ï¼š

- é›†ç¾¤èµ„æºä½¿ç”¨æƒ…å†µï¼ˆCPUã€å†…å­˜ã€GPUã€å­˜å‚¨ï¼‰
- ä½œä¸šç”Ÿå‘½å‘¨æœŸæŒ‡æ ‡
- ç³»ç»Ÿçº§æ€§èƒ½æŒ‡æ ‡
- GPU å¥åº·çŠ¶å†µå’Œä½¿ç”¨æƒ…å†µï¼ˆé€šè¿‡ DCGMï¼‰
- åº”ç”¨ç¨‹åºç‰¹å®šçš„è‡ªå®šä¹‰æŒ‡æ ‡

### æ ¸å¿ƒç»„ä»¶

- **Prometheus**: ç”¨äºæŒ‡æ ‡æ”¶é›†å’Œå‘Šè­¦çš„æ—¶é—´åºåˆ—æ•°æ®åº“
- **Grafana**: ä»ªè¡¨æ¿å¯è§†åŒ–å’Œé¢å‘ç”¨æˆ·çš„æŒ‡æ ‡é¢æ¿
- **Alertmanager**: å¯é€‰çš„å‘Šè­¦è·¯ç”±ç³»ç»Ÿï¼ˆé»˜è®¤ç¦ç”¨ï¼‰
- **DCGM Exporter**: æ¥è‡ª `gpu-operator`ï¼Œå°† GPU æŒ‡æ ‡å¯¼å‡ºåˆ° Prometheus
- **metrics-server**: æä¾› Kubernetes èµ„æºæŒ‡æ ‡ï¼ˆCPUã€å†…å­˜ï¼‰

Crater å°† Grafana ä»ªè¡¨æ¿ **ç›´æ¥é›†æˆåˆ°å…¶å‰ç«¯**ï¼Œä¸ºç”¨æˆ·æä¾›å¤šç»´æ´å¯Ÿï¼Œè€Œæ— éœ€ç¦»å¼€å¹³å° UIã€‚

---

## å­˜å‚¨åç«¯

æˆ‘ä»¬ä½¿ç”¨ **Rook Ceph RBD** ä½œä¸º Prometheus çš„æŒä¹…å­˜å‚¨åç«¯ã€‚

è¿™ç¡®ä¿äº†ï¼š

- å†å²æŒ‡æ ‡çš„é«˜å¯ç”¨æ€§å’ŒæŒä¹…æ€§
- é€‚ç”¨äºå¤§è§„æ¨¡æ—¶é—´åºåˆ—æ‘„å…¥çš„å—çº§æ€§èƒ½

> ğŸ“Œ ç¡®ä¿åœ¨å®‰è£… Prometheus æ ˆ **ä¹‹å‰** æ­£ç¡®å®‰è£…äº† `rook-ceph` å¹¶ä¸” `rook-ceph-rbd` StorageClass å¯ç”¨ã€‚

---

## ä¾èµ–é¡¹

ä¸ºäº†å®Œå…¨å¯ç”¨ Crater ç›‘æ§ï¼Œè¯·ç¡®ä¿ä»¥ä¸‹ç»„ä»¶ **é¦–å…ˆå®‰è£…**ï¼š

| ä¾èµ–é¡¹             | ç›®çš„                                           | å‚è€ƒ                                                                 |
|--------------------|------------------------------------------------|----------------------------------------------------------------------|
| `rook-ceph-rbd`    | æŒä¹…å­˜å‚¨åç«¯                                   | [docs/rook-ceph.md](./rook-ceph.md)                                 |
| `gpu-operator`     | DCGM Exporterï¼ˆNVIDIA GPU æŒ‡æ ‡ï¼‰               | [docs/gpu-operator.md](./gpu-operator.md)                           |
| `metrics-server`   | åŸºæœ¬ CPU/å†…å­˜èµ„æºæŒ‡æ ‡                          | [docs/metrics-server.md](./metrics-server.md)                       |

---

## Crater è‡ªå®šä¹‰é…ç½®

æˆ‘ä»¬æä¾›äº†ä¿®æ”¹åçš„ `values.yaml` å’Œå­å›¾è¡¨é…ç½®ï¼Œç”¨äºï¼š

- å¯ç”¨ DCGM æŒ‡æ ‡æŠ“å–
- é¢„åŠ è½½ä¸ Crater å·¥ä½œè´Ÿè½½ç›¸å…³çš„ Grafana ä»ªè¡¨æ¿é›†åˆ
- å°† Grafana æœåŠ¡ç±»å‹è®¾ç½®ä¸º `ClusterIP` å¹¶ä½¿ç”¨ Crater ç®¡ç†çš„ Ingress
- ä½¿ç”¨é•¿ä¿ç•™çª—å£å’Œè‡ªå®šä¹‰å­˜å‚¨ç±»é…ç½® Prometheus
- è°ƒæ•´é•œåƒä»“åº“å’Œä»“åº“è·¯å¾„

è¯·æ£€æŸ¥å¹¶ç¼–è¾‘è¿™äº›é…ç½®ä»¥åŒ¹é…æ‚¨çš„é›†ç¾¤è®¾ç½®ï¼ŒåŒ…æ‹¬ï¼š

- ğŸ” **StorageClass**: ç¡®ä¿è®¾ç½®ä¸º `rook-ceph-rbd`
- ğŸ“¦ **Image Repositories**: å¦‚æœéœ€è¦ï¼Œè¯·åŒ¹é…æ‚¨çš„æœ¬åœ°/ç§æœ‰ä»“åº“

---

## å®‰è£…

æˆ‘ä»¬å»ºè®®ä½¿ç”¨å¸¦æœ‰ Crater é¢„é…ç½®å€¼çš„å®˜æ–¹ Helm å›¾è¡¨è¿›è¡Œå®‰è£…ã€‚

ğŸ“– è¯¦ç»†æŒ‡å—ï¼š[`deployments/prometheus-stack/README.md`](../deployments/prometheus-stack/README.md)